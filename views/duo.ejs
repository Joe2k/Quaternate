<!DOCTYPE html>
<head>
    <title>Simple realtime chatroom</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="/style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
    <script src="/webrtc.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css"
    />
</head>
<body>
    <div class="container" style="position: relative;">
    <div class="container" style="position: absolute;max-width: 50vh;left:100vh;">
        <div class="title">
            <h3><%=room.roomName%></h3>
        </div>
       
        <div class="card" style="background-color: black; color:aquamarine; font-weight: bolder; font-size: larger;">
            <h3 class="card-header"><%=userName%></h3>
        </div>
       
        <div class="message-box overflow-auto" style="height: 400px;">   
            <div class="card" style="background: url('/assets/img/doodle.jpg'); color: aliceblue; font-weight: bold; font-size: large;">
                <ul class="list-group list-group-flush" id="message-list" style="margin-left: 30px;"></ul>
                <div class="info" style="background-color:transparent;"></div>
            </div>
            
            <div class="card-footer " style="background-color: black;">
                <div class="input-group" style="background-color: transparent;">
                    <input type="text" class="form-control" id="message" placeholder="Send new message" >
                    <div class="input-group-append" style="background-color:transparent;">
                        <button class="btn btn-success" type="button" id="messageBtn">Send</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div id="videos" class="videos" style="position: absolute;">
      <h3 style="margin:0px;text-align: center;"><%=room.roomName%></h1>
      <div id="localVideoContainer" class="videoContainer">
        <video id="localVideo" autoplay muted></video>
      </div>

      <!-- Remote videos get appended here -->
    </div>
    <footer class="footer">
      <button
        type="button"
        class="btn btn-primary"
        id="mic"
        onclick="togglemic()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="currentColor"
          class="bi bi-mic-fill"
          viewBox="0 0 16 16"
        >
          <path d="M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0V3z" />
          <path
            fill-rule="evenodd"
            d="M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5z"
          />
        </svg></button
      ><button
        type="button"
        class="btn btn-primary"
        id="video"
        onclick="togglevideo()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          fill="currentColor"
          class="bi bi-camera-video-fill"
          viewBox="0 0 16 16"
        >
          <path
            fill-rule="evenodd"
            d="M0 5a2 2 0 0 1 2-2h7.5a2 2 0 0 1 1.983 1.738l3.11-1.382A1 1 0 0 1 16 4.269v7.462a1 1 0 0 1-1.406.913l-3.111-1.382A2 2 0 0 1 9.5 13H2a2 2 0 0 1-2-2V5z"
          />
        </svg>
      </button>
    </footer>
    </div>
    <input id="userId" value="<%=userId%>" hidden/>
    <input id="roomId" value="<%=roomId%>" hidden/>
    <input id="userName" value="<%=userName%>" hidden/>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script> -->    
    <script src="https://cdn.socket.io/3.1.1/socket.io.min.js" integrity="sha384-gDaozqUvc4HTgo8iZjwth73C6dDDeOJsAgpxBcMpZYztUfjHXpzrpdrHRdVp8ySO" crossorigin="anonymous"></script>
    <script src="/assets/js/chatroom.js"></script>
    <input id="roomName" value="<%=room.roomName%>" hidden />
    <input id="roomId" value="<%=room._id%>" hidden />
    <input id="userId" value="<%=user._id%>" hidden />
    <input id="userName" value="<%=user.name%>" hidden />

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
      crossorigin="anonymous"
    ></script>
    <script type="text/javascript">
      start();
    </script>
</body>
</html>